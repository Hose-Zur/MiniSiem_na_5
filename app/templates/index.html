{% extends "base.html" %}

{% block title %}Dashboard - miniSIEM{% endblock %}

{% block content %}
<section class="py-4">
    <div class="container">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2>Status Monitorowania</h2>
            <!-- Przycisk odwie偶ania dla caej strony -->
            <button onclick="location.reload()" class="btn btn-sm btn-outline-secondary">Odwie偶 widok</button>
        </div>

        <!-- Kontener, kt贸ry obsu偶y app/static/js/dashboard.js -->
        <div id="hostsContainer" class="list-group">
            <div class="text-center py-5 text-body-secondary">
                <div class="spinner-border text-primary mb-2" role="status"></div>
                <p>adowanie host贸w...</p>
            </div>
        </div>

        <div class="row mb-5">
            <div class="col-md-6">
                <div class="card shadow-sm h-100 border-0">
                    <div class="card-header bg-dark text-white">
                        Top 5 Atakujcych Adres贸w IP
                    </div>
                    <div class="card-body">
                        <canvas id="topIpsChart"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card shadow-sm h-100 border-0 bg-body-tertiary">
                    <div class="card-body d-flex align-items-center justify-content-center text-center p-5">
                        <div>
                            <h4 class="text-body-secondary">Status Systemu</h4>
                            <p class="small text-body-secondary">
                                System dziaa poprawnie.<br>
                                Analiza log贸w odbywa si w trybie przyrostowym.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- SEKCJA 2: Raport Bezpieczestwa (Nowo) -->
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h3 class="text-danger mb-0">Wykryte Zagro偶enia (SIEM)</h3>
            <button id="archiveBtn" class="btn btn-outline-danger btn-sm">
                 Archiwizuj Alerty (JSON)
            </button>
        </div>
        <div class="card shadow-sm">
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-striped table-hover mb-0" id="alertsTable">
                        <thead>
                            <tr>
                                <th>Czas</th>
                                <th>Host</th>
                                <th>Typ Alertu</th>
                                <th>殴r贸do (IP)</th>
                                <th>Wiadomo</th>
                                <th>Poziom</th>
                            </tr>
                        </thead>
                        <tbody id="alertsBody">
                            <!-- JS wypeni to danymi -->
                            <tr>
                                <td colspan="6" class="text-center py-3 text-body-secondary">Brak alert贸w... lub trwa
                                    adowanie.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}